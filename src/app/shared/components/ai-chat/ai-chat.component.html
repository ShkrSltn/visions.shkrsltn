<div class="chat-container">
  <div class="chat-header">
    <h3>{{ "AI_ASSISTANT.AI_CHAT.CHAT_TITLE" | translate }}</h3>
    <p>{{ "AI_ASSISTANT.AI_CHAT.CHAT_SUBTITLE" | translate }}</p>
  </div>

  <div class="chat-messages" #chatMessages>
    @for (message of chatHistory; track $index) {
      <div
        class="message"
        [ngClass]="{
          'user-message': message.role === 'user',
          'assistant-message': message.role === 'assistant',
          typing: message.isTyping
        }"
      >
        <div class="message-content">
          @if (message.role === 'user') {
            <span>{{ message.content }}</span>
          }
          @if (message.role === 'assistant') {
            <span [innerHTML]="message.processedContent"></span>
          }
          @if (message.isTyping) {
            <span class="typing-cursor"></span>
          }
        </div>
      </div>
    }

    @if (isLoading) {
      <div class="loading-indicator">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
    }

    @if (chatHistory.length <= 2) {
      <div class="suggested-questions">
        <p>{{ "AI_ASSISTANT.AI_CHAT.SUGGESTED_QUESTIONS_TITLE" | translate }}</p>
        <div class="question-chips">
          @for (question of suggestedQuestions; track question) {
            <button (click)="askSuggestedQuestion(question)">
              {{ question | translate }}
            </button>
          }
        </div>
      </div>
    }
  </div>

  <div class="chat-input">
    <input
      type="text"
      [(ngModel)]="userMessage"
      placeholder="{{
        'AI_ASSISTANT.AI_CHAT.CHAT_INPUT_PLACEHOLDER' | translate
      }}"
      (keyup.enter)="sendMessage()"
    />
    <button
      (click)="sendMessage()"
      [disabled]="isLoading || !userMessage.trim()"
    >
      <i class="fa-solid fa-paper-plane"></i>
    </button>
  </div>
</div>
